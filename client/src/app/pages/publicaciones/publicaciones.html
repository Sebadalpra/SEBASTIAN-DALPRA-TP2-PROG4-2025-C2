<div class="row">
    <div class="col-lg-8 mx-auto">
        <!-- Formulario para crear publicación -->
        <div class="card shadow-sm mb-4 border-0">
            <div class="card-body p-4">
                <div class="d-flex align-items-center mb-4">
                    <div class="rounded-circle bg-primary bg-gradient text-white d-flex align-items-center justify-content-center me-3" style="width: 45px; height: 45px;">
                        <i class="bi bi-pencil-square fs-5"></i>
                    </div>
                    <h5 class="card-title mb-0 fw-bold">Crear Nueva Publicación</h5>
                </div>
                <form [formGroup]="publicacionesGroup" (ngSubmit)="crearPublicacion()">
                    <div class="mb-3">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-card-heading me-1 text-primary"></i>Título *
                        </label>
                        <input type="text" class="form-control form-control-lg border-2" placeholder="Escribe un título atractivo..." formControlName="titulo" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-chat-left-text me-1 text-primary"></i>Contenido *
                        </label>
                        <textarea class="form-control border-2" rows="4" placeholder="¿Qué estás pensando? Comparte algo interesante..." formControlName="mensaje"></textarea>
                    </div>
                    <div class="mb-4">
                        <label class="form-label fw-semibold">
                            <i class="bi bi-image me-1 text-primary"></i>Imagen (opcional)
                        </label>
                        <div class="input-group">
                            <input type="file" class="form-control border-2" (change)="seleccionarArchivo($event)" formControlName="imagen" accept="image/*" />
                        </div>
                        <small class="text-muted">Formatos admitidos: JPG, PNG, GIF</small>
                    </div>
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="bi bi-send-fill me-2"></i>Publicar Ahora
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Lista de publicaciones -->
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4 class="mb-0">
                <i class="bi bi-newspaper me-2"></i>Publicaciones Recientes
            </h4>
            
            <!-- Controles de ordenamiento -->
            <div class="btn-group" role="group">
                <button 
                    type="button" class="btn btn-sm" 
                    [class.btn-primary]="ordenActual === 'fecha'"
                    [class.btn-outline-primary]="ordenActual !== 'fecha'"
                    (click)="cambiarOrden('fecha')">
                    <i class="bi bi-calendar me-1"></i>Por Fecha
                </button>
                <button 
                    type="button" class="btn btn-sm"
                    [class.btn-primary]="ordenActual === 'likes'"
                    [class.btn-outline-primary]="ordenActual !== 'likes'"
                    (click)="cambiarOrden('likes')">
                    <i class="bi bi-heart me-1"></i>Por Likes
                </button>
            </div>
        </div>

        @for (publicacion of publicacionesPaginadas(); track publicacion._id) {
            <!-- por cada publicacion crear un componente publicacion: -->
            <app-publicacion [publicacion]="publicacion" [usuarioActual]="usuarioActual"></app-publicacion> 
        }

        <!-- paginacion solo si hay mas de 1 pagina (limitada a 5) -->
        @if (totalPaginas() > 1) {
            <div class="d-flex justify-content-center align-items-center gap-3 my-4">
                <button 
                    class="btn btn-outline-primary"
                    (click)="cambiarPagina('anterior')"
                    [disabled]="!hayPaginaAnterior()">
                    <i class="bi bi-chevron-left"></i> Anterior
                </button>
                
                <span class="text-muted">
                    Página {{ paginaActual }} de {{ totalPaginas() }}
                </span>
                
                <button 
                    class="btn btn-outline-primary"
                    (click)="cambiarPagina('siguiente')"
                    [disabled]="!hayPaginaSiguiente()">
                    Siguiente <i class="bi bi-chevron-right"></i>
                </button>
            </div>
        }
    </div>
</div>